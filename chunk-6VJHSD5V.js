import{a as B}from"./chunk-POVCU4V2.js";import{a as F}from"./chunk-FPTE72VE.js";import{a as $}from"./chunk-OK4YZLQP.js";import{a as j,b as z}from"./chunk-7RDUCQRV.js";import{e as T,f as y,g as O}from"./chunk-4AURYXBW.js";import{e as N,g as I,l as V}from"./chunk-OFSL7WP5.js";import{n as q}from"./chunk-CUIRS57P.js";import{B as D,C as R,F as A,J as E,z as k}from"./chunk-XXY3K5GB.js";import{e as L,i as P}from"./chunk-3LJD7IJG.js";import{Ab as s,Fb as x,Jb as l,Kb as M,Wa as m,Yb as c,Zb as S,_b as C,d,hc as g,ka as a,kb as w,qa as v,qb as b,ra as _,yb as h,zb as o}from"./chunk-YWQZOCZU.js";function G(p,t){if(p&1){let e=x();o(0,"div",7),l("click",function(){let n=v(e).$implicit,r=M();return _(r.openTopic(n.id))}),o(1,"div",8),c(2),s()()}if(p&2){let e=t.$implicit;m(2),S(e.name)}}var H=class p{store=a(q);dialog=a(A);route=a(N);router=a(I);swipeNav=a(F);allTopics=this.store.selectSignal($);lists=this.store.selectSignal(V);isLast=g(()=>{let t=this.lists(),e=t.findIndex(i=>i.id===this.listId);return e>=0&&e===t.length-1});listId=Number(this.route.snapshot.paramMap.get("id"))||void 0;currentList=g(()=>this.lists().find(t=>t.id===this.listId));topics=g(()=>{let t=this.currentList();if(!t)return[];let e=new Set(t.topicIds);return this.allTopics().filter(i=>e.has(i.id))});onAdd(){return d(this,null,function*(){let{AddNameDialogComponent:t}=yield import("./chunk-3SODH72N.js");this.dialog.open(t,{data:{title:"New Topic",label:"Topic name",placeholder:"e.g., Health"}}).afterClosed().subscribe(i=>d(this,null,function*(){if(!i)return;let n=this.allTopics(),r=n.length?Math.max(...n.map(u=>u.id))+1:1;this.store.dispatch(j({id:r,name:i}));let f=this.currentList();if(f){let u=Array.from(new Set([...f.topicIds||[],r])),{updateList:W}=yield import("./chunk-CY56UGPL.js");this.store.dispatch(W({id:f.id,changes:{topicIds:u}}))}}))})}onRemove(t){return d(this,null,function*(){this.store.dispatch(z({id:t}));let e=this.currentList();if(e){let i=(e.topicIds||[]).filter(r=>r!==t),{updateList:n}=yield import("./chunk-CY56UGPL.js");this.store.dispatch(n({id:e.id,changes:{topicIds:i}}))}})}back(){this.router.navigate(["/"])}openTopic(t){this.router.navigate(["/topic",t])}onPagePageSwipeLeft(){let t=this.lists();if(!t.length||this.listId===void 0)return;let e=t.findIndex(n=>n.id===this.listId);if(e<0||e===t.length-1)return;let i=t[e+1].id;this.swipeNav.setDirection("left"),this.swipeNav.queueNavigation(["/list",i]),this.swipeNav.beginTransition(),this.swipeNav.setProgress(-1)}onPagePageSwipeRight(){let t=this.lists();if(!t.length||this.listId===void 0)return;let e=t.findIndex(n=>n.id===this.listId);if(e<=0){this.swipeNav.setDirection("right"),this.swipeNav.queueNavigation(["/lists"]),this.swipeNav.beginTransition(),this.swipeNav.setProgress(1);return}let i=t[e-1].id;this.swipeNav.setDirection("right"),this.swipeNav.queueNavigation(["/list",i]),this.swipeNav.beginTransition(),this.swipeNav.setProgress(1)}static \u0275fac=function(e){return new(e||p)};static \u0275cmp=w({type:p,selectors:[["ng-component"]],decls:13,vars:4,consts:[["appSwipePage","",3,"pageSwipeLeft","pageSwipeRight","canSwipeLeft","canSwipeRight"],[1,"section-bar"],["mat-icon-button","","aria-label","Back",3,"click"],[1,"section-title"],[1,"cards"],["class","card","role","button","tabindex","0",3,"click",4,"ngFor","ngForOf"],["mat-fab","","color","primary","aria-label","Add Topic",1,"fab","mat-mdc-extended-fab",3,"click"],["role","button","tabindex","0",1,"card",3,"click"],[1,"card-title"]],template:function(e,i){if(e&1&&(o(0,"section",0),l("pageSwipeLeft",function(){return i.onPagePageSwipeLeft()})("pageSwipeRight",function(){return i.onPagePageSwipeRight()}),o(1,"div",1)(2,"button",2),l("click",function(){return i.back()}),o(3,"mat-icon"),c(4,"arrow_back"),s()(),o(5,"h3",3),c(6),s()(),o(7,"div",4),b(8,G,3,1,"div",5),s(),o(9,"button",6),l("click",function(){return i.onAdd()}),o(10,"mat-icon"),c(11,"add"),s(),c(12," Add Topic "),s()()),e&2){let n;h("canSwipeLeft",!i.isLast())("canSwipeRight",!0),m(6),C(" ",((n=i.currentList())==null?null:n.name)||"Topics"," "),m(2),h("ngForOf",i.topics())}},dependencies:[P,L,T,O,y,R,k,D,E,B],styles:["section[_ngcontent-%COMP%]{position:relative;min-height:60vh}.section-bar[_ngcontent-%COMP%]{display:flex!important;align-items:center;vertical-align:middle;gap:1rem;margin-bottom:8px}.section-title[_ngcontent-%COMP%]{color:var(--md-sys-color-on-surface, #4e342e);margin:0;align-self:center}.fab[_ngcontent-%COMP%]{position:fixed;bottom:24px;right:24px;z-index:100}button[_ngcontent-%COMP%]{padding:.4rem .6rem}.cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:12px}@media (min-width: 600px){.cards[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (min-width: 960px){.cards[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}.card[_ngcontent-%COMP%]{border:1px solid rgba(78,52,46,.25);border-radius:12px;padding:12px 14px;display:flex;align-items:center;justify-content:space-between;background:#fff8f0;cursor:pointer;transition:box-shadow .2s ease,transform .05s ease;touch-action:pan-y;position:relative;z-index:1}.card[_ngcontent-%COMP%]:focus, .card[_ngcontent-%COMP%]:hover{box-shadow:0 1px 4px #3e272333}.card[_ngcontent-%COMP%]:active{transform:scale(.995)}.card-title[_ngcontent-%COMP%]{font-weight:500;color:#3e2723}"]})};export{H as ListComponent};
