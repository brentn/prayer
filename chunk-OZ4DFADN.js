import{a as R,b as V,c as Y,d as q}from"./chunk-N3DYULFS.js";import{o as E,p as U,r as v,s as C}from"./chunk-VFNLJUMT.js";import{Hc as k,a as L,b as K}from"./chunk-J5XAGBFH.js";function Q(){return{ids:[],entities:{}}}function W(){function r(u={}){return Object.assign(Q(),u)}return{getInitialState:r}}function X(){function r(u){let a=y=>y.ids,p=y=>y.entities,h=E(a,p,(y,B)=>y.map(A=>B[A])),m=E(a,y=>y.length);return u?{selectIds:E(u,a),selectEntities:E(u,p),selectAll:E(u,h),selectTotal:E(u,m)}:{selectIds:a,selectEntities:p,selectAll:h,selectTotal:m}}return{getSelectors:r}}var s=(function(r){return r[r.EntitiesOnly=0]="EntitiesOnly",r[r.Both=1]="Both",r[r.None=2]="None",r})(s||{});function l(r){return function(a,p){let h={ids:[...p.ids],entities:L({},p.entities)},m=r(a,h);return m===s.Both?Object.assign({},p,h):m===s.EntitiesOnly?K(L({},p),{entities:h.entities}):p}}function O(r,u){let a=u(r);return k()&&a===void 0&&console.warn("@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.","You should probably provide your own `selectId` implementation.","The entity that was passed:",r,"The `selectId` implementation:",u.toString()),a}function z(r){function u(c,n){let e=O(c,r);return e in n.entities?s.None:(n.ids.push(e),n.entities[e]=c,s.Both)}function a(c,n){let e=!1;for(let t of c)e=u(t,n)!==s.None||e;return e?s.Both:s.None}function p(c,n){return n.ids=[],n.entities={},a(c,n),s.Both}function h(c,n){let e=O(c,r);return e in n.entities?(n.entities[e]=c,s.EntitiesOnly):(n.ids.push(e),n.entities[e]=c,s.Both)}function m(c,n){let e=c.map(t=>h(t,n));switch(!0){case e.some(t=>t===s.Both):return s.Both;case e.some(t=>t===s.EntitiesOnly):return s.EntitiesOnly;default:return s.None}}function y(c,n){return B([c],n)}function B(c,n){let t=(c instanceof Array?c:n.ids.filter(i=>c(n.entities[i]))).filter(i=>i in n.entities).map(i=>delete n.entities[i]).length>0;return t&&(n.ids=n.ids.filter(i=>i in n.entities)),t?s.Both:s.None}function A(c){return Object.assign({},c,{ids:[],entities:{}})}function I(c,n,e){let t=e.entities[n.id],i=Object.assign({},t,n.changes),o=O(i,r),d=o!==n.id;return d&&(c[n.id]=o,delete e.entities[n.id]),e.entities[o]=i,d}function x(c,n){return N([c],n)}function N(c,n){let e={};return c=c.filter(i=>i.id in n.entities),c.length>0?c.filter(o=>I(e,o,n)).length>0?(n.ids=n.ids.map(o=>e[o]||o),s.Both):s.EntitiesOnly:s.None}function S(c,n){let t=n.ids.reduce((i,o)=>{let d=c(n.entities[o]);return d!==n.entities[o]&&i.push({id:o,changes:d}),i},[]).filter(({id:i})=>i in n.entities);return N(t,n)}function T({map:c,id:n},e){let t=e.entities[n];if(!t)return s.None;let i=c(t);return x({id:n,changes:i},e)}function F(c,n){return w([c],n)}function w(c,n){let e=[],t=[];for(let d of c){let f=O(d,r);f in n.entities?t.push({id:f,changes:d}):e.push(d)}let i=N(t,n),o=a(e,n);switch(!0){case(o===s.None&&i===s.None):return s.None;case(o===s.Both||i===s.Both):return s.Both;default:return s.EntitiesOnly}}return{removeAll:A,addOne:l(u),addMany:l(a),setAll:l(p),setOne:l(h),setMany:l(m),updateOne:l(x),updateMany:l(N),upsertOne:l(F),upsertMany:l(w),removeOne:l(y),removeMany:l(B),map:l(S),mapOne:l(T)}}function Z(r,u){let{removeOne:a,removeMany:p,removeAll:h}=z(r);function m(e,t){return y([e],t)}function y(e,t){let i=e.filter(o=>!(O(o,r)in t.entities));return i.length===0?s.None:(n(i,t),s.Both)}function B(e,t){return t.entities={},t.ids=[],y(e,t),s.Both}function A(e,t){let i=O(e,r);return i in t.entities?(t.ids=t.ids.filter(o=>o!==i),n([e],t),s.Both):m(e,t)}function I(e,t){let i=e.map(o=>A(o,t));switch(!0){case i.some(o=>o===s.Both):return s.Both;case i.some(o=>o===s.EntitiesOnly):return s.EntitiesOnly;default:return s.None}}function x(e,t){return S([e],t)}function N(e,t,i){if(!(t.id in i.entities))return!1;let o=i.entities[t.id],d=Object.assign({},o,t.changes),f=O(d,r);return delete i.entities[t.id],e.push(d),f!==t.id}function S(e,t){let i=[],o=e.filter(d=>N(i,d,t)).length>0;if(i.length===0)return s.None;{let d=t.ids,f=[];return t.ids=t.ids.filter((M,b)=>M in t.entities?!0:(f.push(b),!1)),n(i,t),!o&&f.every(M=>t.ids[M]===d[M])?s.EntitiesOnly:s.Both}}function T(e,t){let i=t.ids.reduce((o,d)=>{let f=e(t.entities[d]);return f!==t.entities[d]&&o.push({id:d,changes:f}),o},[]);return S(i,t)}function F({map:e,id:t},i){let o=i.entities[t];if(!o)return s.None;let d=e(o);return x({id:t,changes:d},i)}function w(e,t){return c([e],t)}function c(e,t){let i=[],o=[];for(let M of e){let b=O(M,r);b in t.entities?o.push({id:b,changes:M}):i.push(M)}let d=S(o,t),f=y(i,t);switch(!0){case(f===s.None&&d===s.None):return s.None;case(f===s.Both||d===s.Both):return s.Both;default:return s.EntitiesOnly}}function n(e,t){e.sort(u);let i=[],o=0,d=0;for(;o<e.length&&d<t.ids.length;){let f=e[o],M=O(f,r),b=t.ids[d],J=t.entities[b];u(f,J)<=0?(i.push(M),o++):(i.push(b),d++)}o<e.length?t.ids=i.concat(e.slice(o).map(r)):t.ids=i.concat(t.ids.slice(d)),e.forEach((f,M)=>{t.entities[r(f)]=f})}return{removeOne:a,removeMany:p,removeAll:h,addOne:l(m),updateOne:l(x),upsertOne:l(w),setAll:l(B),setOne:l(A),setMany:l(I),addMany:l(y),updateMany:l(S),upsertMany:l(c),map:l(T),mapOne:l(F)}}function G(r={}){let{selectId:u,sortComparer:a}={selectId:r.selectId??(y=>y.id),sortComparer:r.sortComparer??!1},p=W(),h=X(),m=a?Z(u,a):z(u);return L(L(L({selectId:u,sortComparer:a},p),h),m)}var _="lists",g=G(),$=g.getInitialState();function P(r){let u=r.ids;return u.length?Math.max(...u)+1:1}var D=C($,v(R,(r,{name:u})=>{let a=P(r);return g.addOne({id:a,name:u,topicIds:[]},r)}),v(V,(r,{id:u,changes:a})=>g.updateOne({id:u,changes:a},r)),v(Y,(r,{id:u})=>g.removeOne(u,r)),v(q,r=>g.removeAll(r))),tt=U({name:_,reducer:D}),{name:dt,reducer:lt,selectListsState:H}=tt,{selectAll:at,selectEntities:ft,selectIds:yt,selectTotal:pt}=g.getSelectors();var j=g.getSelectors(H),Ot=j.selectAll,gt=j.selectEntities,bt=j.selectTotal;export{G as a,$ as b,lt as c,Ot as d};
