<div class="card" [class.answered]="isAnswered || localIsAnswered">
    @if (!(isAnswered || localIsAnswered) && !showAnswerForm) {
        <button mat-button class="answer-tab" (click)="onAnsweredClick()" title="Mark as Answered">
            record answer
        </button>
    }
    <div class="card-header">
        <div>
            @if (priority && priority > 1) {
                <div class="priority-badge" [class]="getPriorityClass()">{{ priority }}</div>
            }
        </div>
        <div class="header-right">
            @if (isAnswered || localIsAnswered) {
                <div class="answered-info">
                    <div class="answered-summary">{{ getAnsweredSummary() }}</div>
                    <div class="answered-date">{{ getAnsweredDateText() }}</div>
                </div>
            } @else {
                @if (prayerCount !== undefined) {
                    <span class="prayer-count-badge">{{ prayerCount }}</span>
                }
                @if (createdDate) {
                    <span class="since-text">since {{ createdDate | date }}</span>
                }
            }
        </div>
    </div>
    <div class="card-content">
        <mat-icon class="card-icon">{{ icon }}</mat-icon>
        @if (topicName) {
            <div class="card-topic">{{topicName}}:</div>
        }
        <div class="card-title">{{ title }}</div>
        @if ((isAnswered || localIsAnswered) && (answerDescription || localAnswerDescription)) {
            <div class="answer-description-box" [@answerFadeIn]>
                {{ answerDescription || localAnswerDescription }}
            </div>
        }
        @if (showAnswerForm) {
            <div class="answer-form" [@slideInOut]>
                <button mat-icon-button class="cancel-x" (click)="onAnswerCancel()" title="Cancel">
                    <mat-icon>close</mat-icon>
                </button>
                <mat-form-field appearance="outline" class="answer-textarea">
                    <mat-label>How was this request answered?</mat-label>
                    <textarea matInput [(ngModel)]="answerText" (blur)="onAnswerSubmit()" rows="4"
                        placeholder="Describe the answer..." cdkTextareaAutosize cdkAutosizeMinRows="3"
                        cdkAutosizeMaxRows="6"></textarea>
                </mat-form-field>
            </div>
        }
    </div>
    @if (listName) {
        <div class="card-footer">
            {{ listName}}
        </div>
    }
</div>