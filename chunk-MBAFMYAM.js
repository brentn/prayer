import{a as $,b as j,c as z,d as B}from"./chunk-OUIKPR7K.js";import{d as k}from"./chunk-FFRVPE7Q.js";import"./chunk-BQHBFRWM.js";import{a as q}from"./chunk-NXKPZVRN.js";import"./chunk-AKY6NCKP.js";import{c as P,e as S,h as I,i as D,m as F}from"./chunk-EQTONB35.js";import"./chunk-6ICJU5RU.js";import{b as H,d as W}from"./chunk-Q6TWIOL2.js";import{n as R}from"./chunk-PRSFUHHW.js";import{c as E,h as N}from"./chunk-FEMVN73J.js";import{a as V,d as A}from"./chunk-5XC6QZKK.js";import{h as O}from"./chunk-745RUJWA.js";import{Eb as x,Fb as y,Gb as h,Hb as r,Ib as a,Nb as _,Rb as g,Tb as C,_a as l,bc as w,d as c,ec as s,fc as L,gc as T,ka as m,pb as v,pc as M,qa as p,ra as u}from"./chunk-F5KG7EK2.js";var K=(d,t)=>t.id;function Q(d,t){if(d&1){let e=_();r(0,"div",10),g("click",function(){let n=p(e).$implicit,o=C();return u(o.openTopic(n.id))}),r(1,"div",7),s(2),a()()}if(d&2){let e=t.$implicit;l(2),L(e.name)}}var G=class d{store=m(R);dialog=m(E);route=m(P);router=m(S);allTopics=this.store.selectSignal(q);lists=this.store.selectSignal(F);listId=Number(this.route.snapshot.paramMap.get("id"))||void 0;currentList=M(()=>this.lists().find(t=>t.id===this.listId));topics=M(()=>{let t=this.currentList();if(!t)return[];let e=new Set(t.topicIds);return this.allTopics().filter(i=>e.has(i.id))});onAdd(){return c(this,null,function*(){let{AddNameDialogComponent:t}=yield import("./chunk-ZJ7JTUJG.js");this.dialog.open(t,{data:{title:"New Topic",label:"Topic name",placeholder:"e.g., Health"}}).afterClosed().subscribe(i=>c(this,null,function*(){if(!i)return;let n=this.allTopics(),o=n.length?Math.max(...n.map(b=>b.id))+1:1;this.store.dispatch(H({id:o,name:i}));let f=this.currentList();if(f){let b=Array.from(new Set([...f.topicIds||[],o])),{updateList:J}=yield import("./chunk-N2HLA47D.js");this.store.dispatch(J({id:f.id,changes:{topicIds:b}}))}}))})}onRename(){return c(this,null,function*(){let t=this.currentList();if(!t)return;let{AddNameDialogComponent:e}=yield import("./chunk-ZJ7JTUJG.js"),i=this.dialog.open(e,{data:{title:"Rename List",label:"List name",placeholder:"e.g., Family"}});i.afterOpened().subscribe(()=>{i.componentInstance?.value?.setValue(t.name)}),i.afterClosed().subscribe(n=>c(this,null,function*(){if(!n)return;let{updateList:o}=yield import("./chunk-N2HLA47D.js");this.store.dispatch(o({id:t.id,changes:{name:n}}))}))})}onDelete(){return c(this,null,function*(){let t=this.currentList();if(!t||(this.topics()||[]).length>0)return;let{ConfirmDialogComponent:e}=yield import("./chunk-MAEIQDBH.js");this.dialog.open(e,{data:{title:"Delete List",message:`Delete "${t.name}"? This cannot be undone.`,confirmText:"Delete",cancelText:"Cancel"}}).afterClosed().subscribe(n=>c(this,null,function*(){if(!n)return;let{removeList:o}=yield import("./chunk-N2HLA47D.js");this.store.dispatch(o({id:t.id})),this.router.navigate(["/"])}))})}onRemove(t){return c(this,null,function*(){this.store.dispatch(W({id:t}));let e=this.currentList();if(e){let i=(e.topicIds||[]).filter(o=>o!==t),{updateList:n}=yield import("./chunk-N2HLA47D.js");this.store.dispatch(n({id:e.id,changes:{topicIds:i}}))}})}back(){this.router.navigate(["/"])}openTopic(t){this.router.navigate(["/topic",t])}static \u0275fac=function(e){return new(e||d)};static \u0275cmp=v({type:d,selectors:[["ng-component"]],decls:27,vars:3,consts:[["listMenu","matMenu"],[1,"section-bar"],[1,"section-title"],["mat-icon-button","","aria-label","List menu",1,"section-menu",3,"matMenuTriggerFor"],[1,"cards"],["role","button","tabindex","0",1,"card"],["role","button","tabindex","0","aria-label","Add Topic",1,"card","add-card",3,"click"],[1,"card-title"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click","disabled"],["role","button","tabindex","0",1,"card",3,"click"]],template:function(e,i){if(e&1){let n=_();r(0,"section")(1,"div",1)(2,"h3",2),s(3),a(),r(4,"button",3)(5,"mat-icon"),s(6,"more_vert"),a()()(),r(7,"div",4),x(8,Q,3,1,"div",5,K),r(10,"div",6),g("click",function(){return p(n),u(i.onAdd())}),r(11,"div",7)(12,"mat-icon"),s(13,"add"),a(),s(14," Add Topic "),a()()(),r(15,"mat-menu",null,0)(17,"button",8),g("click",function(){return p(n),u(i.onRename())}),r(18,"mat-icon"),s(19,"edit"),a(),r(20,"span"),s(21,"Rename"),a()(),r(22,"button",9),g("click",function(){return p(n),u(i.onDelete())}),r(23,"mat-icon"),s(24,"delete"),a(),r(25,"span"),s(26,"Delete"),a()()()()}if(e&2){let n,o=w(16);l(3),T(" ",((n=i.currentList())==null?null:n.name)||"Topics"," "),l(),h("matMenuTriggerFor",o),l(4),y(i.topics()),l(14),h("disabled",i.topics().length>0)}},dependencies:[O,k,D,I,A,V,N,B,j,$,z],styles:["section[_ngcontent-%COMP%]{position:relative;height:calc(100vh - 5rem);margin:1rem;border:1px solid rgba(255,255,255,.2);border-radius:12px}.section-bar[_ngcontent-%COMP%]{display:flex!important;align-items:center;vertical-align:middle;gap:1rem;margin-bottom:8px;position:relative}.section-title[_ngcontent-%COMP%]{color:var(--md-sys-color-on-primary);background-color:var(--md-sys-color-primary);margin:0;text-align:center;font-weight:400;flex-grow:1;padding:.5rem .75rem;border:1px solid rgba(255,255,255,.2);border-top-left-radius:12px;border-top-right-radius:12px}.section-menu[_ngcontent-%COMP%]{position:absolute;right:0}.fab[_ngcontent-%COMP%]{position:fixed;bottom:24px;right:24px;z-index:100;--mdc-extended-fab-container-color: var(--md-sys-color-primary-container);--mdc-fab-container-color: var(--md-sys-color-primary-container);--mdc-extended-fab-label-text-color: var(--md-sys-color-on-primary);--mdc-fab-foreground-color: var(--md-sys-color-on-primary);--mat-fab-foreground-color: var(--md-sys-color-on-primary);background-color:var(--md-sys-color-primary-container)!important;color:var(--md-sys-color-on-primary)!important}button[_ngcontent-%COMP%]{padding:.4rem .6rem}.cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;padding:.5rem;gap:1rem}@media (min-width: 600px){.cards[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (min-width: 960px){.cards[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}.card[_ngcontent-%COMP%]{border:1px solid rgba(255,255,255,.2);border-radius:12px;padding:12px 14px;display:flex;align-items:center;justify-content:space-between;background:var(--md-sys-color-primary);cursor:pointer;transition:box-shadow .2s ease,transform .05s ease;touch-action:pan-y;position:relative;z-index:1}.card[_ngcontent-%COMP%]:focus, .card[_ngcontent-%COMP%]:hover{box-shadow:0 1px 4px #3e272333}.card[_ngcontent-%COMP%]:active{transform:scale(.995)}.card-title[_ngcontent-%COMP%]{font-weight:300;color:var(--md-sys-color-on-primary)}.card.add-card[_ngcontent-%COMP%]{opacity:.5;display:flex;align-items:center}.card.add-card[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.card.add-card[_ngcontent-%COMP%]:hover, .card.add-card[_ngcontent-%COMP%]:focus{opacity:.7}"]})};export{G as ListComponent};
