import{a as B}from"./chunk-VROSRYIY.js";import"./chunk-P4G45SAU.js";import"./chunk-V2M3KRAM.js";import{b as j}from"./chunk-D5UZXCWY.js";import"./chunk-OS5DXOMC.js";import{c as z}from"./chunk-5L3NEEFY.js";import"./chunk-N3BUTQJV.js";import{c as O,e as S,h as I,i as D}from"./chunk-BTN7GLWV.js";import"./chunk-UDYWFERJ.js";import{b as F,d as $}from"./chunk-GJYSUC5I.js";import{n as R}from"./chunk-SHVGM3UO.js";import"./chunk-3POYQ5FD.js";import{c as N,h as A}from"./chunk-4RA4IASQ.js";import"./chunk-75Q5HG54.js";import{V as E,Y as V,i as P}from"./chunk-W4MHS7CD.js";import{Fb as g,Gb as h,Ib as k,Jb as L,Kb as C,Lb as a,Mb as s,Nb as T,Rb as x,Vb as p,Xb as c,ab as l,d,jc as _,kc as y,la as f,ra as m,rb as M,sa as u,xc as w}from"./chunk-H2AXNUGV.js";var q=(o,e)=>e.id;function G(o,e){if(o&1&&(a(0,"h3",3),_(1),s()),o&2){let t,i=c();l(),y(((t=i.currentList())==null?null:t.name)||"Topics")}}function J(o,e){if(o&1){let t=x();a(0,"input",11),p("click",function(n){return m(t),u(n.stopPropagation())})("input",function(n){m(t);let r=c();return u(r.editName=n.target.value)})("keydown.enter",function(){m(t);let n=c();return u(n.saveEdit())})("keydown.escape",function(){m(t);let n=c();return u(n.cancelEdit())}),s()}if(o&2){let t=c();C("value",t.editName)}}function K(o,e){if(o&1){let t=x();a(0,"button",13),p("click",function(n){return m(t),c(2).onDelete(),u(n.stopPropagation())}),a(1,"mat-icon",14),_(2,"delete"),s()()}if(o&2){let t=c(2);C("disabled",t.topics().length>0)}}function Q(o,e){if(o&1&&(a(0,"div",5),g(1,K,3,1,"button",12),s()),o&2){let t=c();l(),h(t.topics().length===0?1:-1)}}function U(o,e){if(o&1){let t=x();a(0,"div",15),p("click",function(){let n=m(t).$implicit,r=c();return u(r.openTopic(n.id))}),a(1,"div",9),_(2),s()()}if(o&2){let t=e.$implicit;l(2),y(t.name)}}var H=class o{store=f(R);dialog=f(N);route=f(O);router=f(S);editing=!1;editName="";allTopics=this.store.selectSignal(j);lists=this.store.selectSignal(z);listId=Number(this.route.snapshot.paramMap.get("id"))||void 0;currentList=w(()=>this.lists().find(e=>e.id===this.listId));topics=w(()=>{let e=this.currentList();if(!e)return[];let t=new Set(e.topicIds);return this.allTopics().filter(i=>t.has(i.id))});onAdd(){return d(this,null,function*(){let{AddNameDialogComponent:e}=yield import("./chunk-4ZXC32NC.js");this.dialog.open(e,{data:{title:"New Topic",label:"Topic name",placeholder:"e.g., Health"}}).afterClosed().subscribe(i=>d(this,null,function*(){if(!i)return;let n=this.allTopics(),r=n.length?Math.max(...n.map(v=>v.id))+1:1;this.store.dispatch(F({id:r,name:i}));let b=this.currentList();if(b){let v=Array.from(new Set([...b.topicIds||[],r])),{updateList:W}=yield import("./chunk-XFKVAK7G.js");this.store.dispatch(W({id:b.id,changes:{topicIds:v}}))}}))})}onRename(){return d(this,null,function*(){let e=this.currentList();if(!e)return;let{AddNameDialogComponent:t}=yield import("./chunk-4ZXC32NC.js"),i=this.dialog.open(t,{data:{title:"Rename List",label:"List name",placeholder:"e.g., Family"}});i.afterOpened().subscribe(()=>{i.componentInstance?.value?.setValue(e.name)}),i.afterClosed().subscribe(n=>d(this,null,function*(){if(!n)return;let{updateList:r}=yield import("./chunk-XFKVAK7G.js");this.store.dispatch(r({id:e.id,changes:{name:n}}))}))})}onDelete(){return d(this,null,function*(){let e=this.currentList();if(!e||(this.topics()||[]).length>0)return;let{ConfirmDialogComponent:t}=yield import("./chunk-UN2FCCVJ.js");this.dialog.open(t,{data:{title:"Delete List",message:`Delete "${e.name}"? This cannot be undone.`,confirmText:"Delete",cancelText:"Cancel"}}).afterClosed().subscribe(n=>d(this,null,function*(){if(!n)return;let{removeList:r}=yield import("./chunk-XFKVAK7G.js");this.store.dispatch(r({id:e.id})),this.router.navigate(["/"])}))})}onRemove(e){return d(this,null,function*(){this.store.dispatch($({id:e}));let t=this.currentList();if(t){let i=(t.topicIds||[]).filter(r=>r!==e),{updateList:n}=yield import("./chunk-XFKVAK7G.js");this.store.dispatch(n({id:t.id,changes:{topicIds:i}}))}})}back(){this.router.navigate(["/"])}openTopic(e){this.router.navigate(["/topic",e])}startEdit(){if(this.editing)return;let e=this.currentList();this.editing=!0,this.editName=e?.name||""}saveEdit(){return d(this,null,function*(){let e=this.currentList();if(!e){this.editing=!1;return}let t=(this.editName||"").trim();if(t&&t!==e.name){let{updateList:i}=yield import("./chunk-XFKVAK7G.js");this.store.dispatch(i({id:e.id,changes:{name:t}}))}this.editing=!1})}cancelEdit(){this.editing=!1,this.editName=""}onSectionClick(){this.editing&&this.saveEdit()}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=M({type:o,selectors:[["ng-component"]],decls:15,vars:3,consts:[[3,"click"],[1,"section-bar",3,"click"],[1,"title-stack",3,"click"],[1,"section-title"],["type","text","autofocus","",1,"edit-input",3,"value"],[1,"section-menu"],[1,"cards"],["role","button","tabindex","0",1,"card"],["role","button","tabindex","0","aria-label","Add Topic",1,"card","add-card",3,"click"],[1,"card-title"],[3,"listId"],["type","text","autofocus","",1,"edit-input",3,"click","input","keydown.enter","keydown.escape","value"],["mat-icon-button","","color","warn","aria-label","Delete List",1,"trash-btn",3,"disabled"],["mat-icon-button","","color","warn","aria-label","Delete List",1,"trash-btn",3,"click","disabled"],[1,"trash"],["role","button","tabindex","0",1,"card",3,"click"]],template:function(t,i){t&1&&(a(0,"section",0),p("click",function(){return i.onSectionClick()}),a(1,"div",1),p("click",function(r){return r.stopPropagation()}),a(2,"div",2),p("click",function(){return i.startEdit()}),g(3,G,2,1,"h3",3)(4,J,1,1,"input",4),s(),g(5,Q,2,1,"div",5),s(),a(6,"div",6),k(7,U,3,1,"div",7,q),a(9,"div",8),p("click",function(){return i.onAdd()}),a(10,"div",9)(11,"mat-icon"),_(12,"add"),s(),_(13," Add Topic "),s()()()(),T(14,"app-pray-tab",10)),t&2&&(l(3),h(i.editing?4:3),l(2),h(i.editing?5:-1),l(2),L(i.topics()),l(7),C("listId",i.listId))},dependencies:[P,D,I,V,E,A,B],styles:["section[_ngcontent-%COMP%]{position:relative;height:calc(100vh - 6rem);margin:1rem;border:1px solid rgba(255,255,255,.2);border-radius:12px}.section-bar[_ngcontent-%COMP%]{display:flex!important;align-items:center;vertical-align:middle;gap:1rem;margin-bottom:.5rem;position:relative}.section-title[_ngcontent-%COMP%]{margin:0;color:var(--md-sys-color-on-primary);background-color:var(--app-color-primary-darker);text-align:center;font-weight:400;flex-grow:1;padding:.75rem;border:1px solid rgba(255,255,255,.2);border-top-left-radius:12px;border-top-right-radius:12px}.section-menu[_ngcontent-%COMP%]{position:absolute;right:0}.title-stack[_ngcontent-%COMP%]{display:flex;flex:1}.edit-input[_ngcontent-%COMP%]{width:100%;background:transparent;border:none;outline:none;color:var(--md-sys-color-on-primary);background-color:var(--app-color-primary-darker);font:inherit;padding:.95rem 2rem;border-top-left-radius:12px;border-top-right-radius:12px;box-shadow:inset 0 -1px #ffffff4d}.trash-btn[_ngcontent-%COMP%]{position:relative}.trash-btn[disabled][_ngcontent-%COMP%]   .trash[_ngcontent-%COMP%]{opacity:.4}.trash-btn[_ngcontent-%COMP%]   .ban[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#ffffffd9;font-size:20px;pointer-events:none;z-index:1}.fab[_ngcontent-%COMP%]{position:fixed;bottom:24px;right:24px;z-index:100;--mdc-extended-fab-container-color: var(--md-sys-color-primary-container);--mdc-fab-container-color: var(--md-sys-color-primary-container);--mdc-extended-fab-label-text-color: var(--md-sys-color-on-primary);--mdc-fab-foreground-color: var(--md-sys-color-on-primary);--mat-fab-foreground-color: var(--md-sys-color-on-primary);background-color:var(--md-sys-color-primary-container)!important;color:var(--md-sys-color-on-primary)!important}button[_ngcontent-%COMP%]{padding:.4rem .6rem}.cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;padding:.5rem;gap:1rem}@media (min-width: 600px){.cards[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (min-width: 960px){.cards[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}.card[_ngcontent-%COMP%]{border:1px solid rgba(255,255,255,.2);border-radius:12px;padding:12px 14px;display:flex;align-items:center;justify-content:space-between;background:var(--md-sys-color-primary);cursor:pointer;transition:box-shadow .2s ease,transform .05s ease;touch-action:pan-y;position:relative;z-index:1}.card[_ngcontent-%COMP%]:focus, .card[_ngcontent-%COMP%]:hover{box-shadow:0 1px 4px #3e272333}.card[_ngcontent-%COMP%]:active{transform:scale(.995)}.card-title[_ngcontent-%COMP%]{font-weight:300;color:var(--md-sys-color-on-primary)}.card.add-card[_ngcontent-%COMP%]{opacity:.5;display:flex;align-items:center}.card.add-card[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.card.add-card[_ngcontent-%COMP%]:hover, .card.add-card[_ngcontent-%COMP%]:focus{opacity:.7}"]})};export{H as ListComponent};
